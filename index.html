<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lampaka Jump</title>
<style>
  html, body {
    margin: 0; padding: 0;
    background: #87CEFA; /* Himmelblau */
    overflow: hidden;
    touch-action: manipulation;
    user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
  }
  canvas {
    display: block;
    background: #87CEFA;
    width: 100vw;
    height: 100vh;
  }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
// Canvas Setup
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let width, height;
function resize() {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
}
window.addEventListener('resize', resize);
resize();

// Spielvariablen
const groundHeight = 100; // Bodenhöhe vom unteren Bildschirmrand
const lampakaSize = 80; // Größe Lampaka & Kakteen (quadratisch)
let lampaka = {
  x: width * 0.15,
  y: height - groundHeight - lampakaSize,
  vy: 0,
  jumping: false
};
let gravity = 2.0;
let jumpStrength = -40;
let speed = 4;
let score = 0;
let highscore = localStorage.getItem('highscore') || 0;
let gameOver = false;

// Hindernisse (Kakteen)
let boxes = [];
const minGap = 400;
const maxGap = 900;

// Lampaka Bild (Sprite)
// Bitte ersetze die URL durch den Pfad zu deiner Lampaka.png im Projektordner oder einer URL
const lampakaImg = new Image();
lampakaImg.src = "Lampaka.png"; // z.B. "Lampaka.png" im gleichen Ordner

// Kakteen zeichnen
function drawCactus(x, y, size) {
  ctx.fillStyle = '#228B22'; // Dunkelgrün
  const w = size * 0.5;
  const h = size;
  ctx.fillRect(x, y - h, w, h); // Stamm
  ctx.fillRect(x - w * 0.5, y - h * 0.7, w * 0.5, h * 0.3); // linker Arm
  ctx.fillRect(x + w, y - h * 0.7, w * 0.5, h * 0.3); // rechter Arm
}

// Boxen erzeugen
function spawnBox() {
  const lastX = boxes.length > 0 ? boxes[boxes.length - 1].x : width + 200;
  const gap = Math.random() * (maxGap - minGap) + minGap;
  boxes.push({ x: lastX + gap, y: height - groundHeight });
}
// Initial Boxes
for (let i = 0; i < 5; i++) spawnBox();

// Steuerung (Springen)
function jump() {
  if (!lampaka.jumping && !gameOver) {
    lampaka.vy = jumpStrength;
    lampaka.jumping = true;
  }
}
window.addEventListener('touchstart', e => { e.preventDefault(); jump(); }, {passive:false});
window.addEventListener('mousedown', jump);

// Update Game
function update() {
  if (gameOver) return;

  // Physik Lampaka
  lampaka.vy += gravity;
  lampaka.y += lampaka.vy;

  // Auf Boden aufsetzen
  if (lampaka.y > height - groundHeight - lampakaSize) {
    lampaka.y = height - groundHeight - lampakaSize;
    lampaka.vy = 0;
    lampaka.jumping = false;
  }

  // Hindernisse bewegen
  for (let box of boxes) {
    box.x -= speed;
  }

  // Entferne Kakteen, die raus sind + neue erzeugen
  if (boxes.length > 0 && boxes[0].x < -lampakaSize) {
    boxes.shift();
    spawnBox();
    score++;
    if (score > highscore) {
      highscore = score;
      localStorage.setItem('highscore', highscore);
    }
    // Geschwindigkeit leicht erhöhen alle 5 Punkte
    if (score % 5 === 0) speed += 0.5;
  }

  // Kollision prüfen (vereinfacht: Rechtecke)
  for (let box of boxes) {
    const cactusW = lampakaSize * 0.5;
    const cactusH = lampakaSize;
    if (
      lampaka.x < box.x + cactusW &&
      lampaka.x + lampakaSize > box.x &&
      lampaka.y + lampakaSize > box.y - cactusH
    ) {
      gameOver = true;
      setTimeout(() => {
        resetGame();
      }, 1500);
    }
  }
}

// Reset nach Game Over
function resetGame() {
  score = 0;
  speed = 4;
  lampaka.y = height - groundHeight - lampakaSize;
  lampaka.vy = 0;
  lampaka.jumping = false;
  boxes = [];
  for (let i = 0; i < 5; i++) spawnBox();
  gameOver = false;
}

// Zeichnen
function draw() {
  // Hintergrund Himmel
  ctx.fillStyle = '#87CEFA';
  ctx.fillRect(0, 0, width, height);

  // Boden grün
  ctx.fillStyle = '#228B22';
  ctx.fillRect(0, height - groundHeight, width, groundHeight);

  // Lampaka zeichnen (Bild oder rotes Rechteck, falls Bild nicht geladen)
  if (lampakaImg.complete && lampakaImg.naturalWidth !== 0) {
    ctx.drawImage(lampakaImg, lampaka.x, lampaka.y, lampakaSize, lampakaSize);
  } else {
    ctx.fillStyle = 'red';
    ctx.fillRect(lampaka.x, lampaka.y, lampakaSize, lampakaSize);
  }

  // Kakteen zeichnen
  for (let box of boxes) {
    drawCactus(box.x, box.y, lampakaSize);
  }

  // Score & Highscore
  ctx.fillStyle = 'white';
  ctx.font = '30px monospace';
  ctx.fillText('Punkte: ' + score, 20, 50);
  ctx.fillText('Highscore: ' + highscore, 20, 90);

  // Game Over Overlay
  if (gameOver) {
    ctx.fillStyle = 'rgba(0,0,0,0.5)';
    ctx.fillRect(0, 0, width, height);
    ctx.fillStyle = 'white';
    ctx.font = '80px monospace';
    ctx.textAlign = 'center';
    ctx.fillText('GAME OVER', width/2, height/2);
    ctx.textAlign = 'start';
  }
}

// Game Loop
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
